[SERVICE]
    flush        5
    log_level    info
    parsers_file parsers.conf
    storage.path /fluent-bit/positions

[INPUT]
    name              tail
    tag               docker.*
    path              /var/lib/docker/containers/*/*.log
    parser            docker
    db                /fluent-bit/positions/tail.db
    mem_buf_limit     5MB
    skip_long_lines   on
    refresh_interval  10

[FILTER]
    name              modify
    match             docker.*
    add               hostname truenas

[OUTPUT]
    name              loki
    match             docker.*
    host              victoria-logs.goyangi.io
    port              443
    uri               /loki/api/v1/push
    labels            job=truenas-docker, hostname=truenas
    label_keys        $container_name
    auto_kubernetes_labels off
    tls               on
    tls.verify        on
