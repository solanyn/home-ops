apiVersion: gateway.envoyproxy.io/v1alpha1
kind: SecurityPolicy
metadata:
  name: kubeflow-oidc
  namespace: istio-system
spec:
  targetRefs:
    - group: gateway.networking.k8s.io
      kind: HTTPRoute
      name: kubeflow
  oidc:
    provider:
      issuer: https://id.goyangi.io
    # clientIDRef:
    #   name: kubeflow-auth-secret
    clientID: 7162a455-eda2-4143-8b00-869fc1e66387
    clientSecret:
      name: kubeflow-auth-secret
    redirectURL: https://kubeflow.goyangi.io/oauth2/callback
    logoutPath: /oauth2/logout
    scopes:
      - openid
      - profile
      - email
      - offline_access
    jwt:
      providers:
        - name: pocket-id
          issuer: https://id.goyangi.io
          claimToHeaders:
            - claim: email
              header: kubeflow-userid
            - claim: groups
              header: kubeflow-groups
