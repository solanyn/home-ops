---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: redpanda
spec:
  interval: 1h
  chart:
    spec:
      chart: redpanda
      version: 25.3.2
      sourceRef:
        kind: HelmRepository
        name: redpanda
        namespace: streaming
  values:
    fullnameOverride: redpanda
    statefulset:
      replicas: 1
      podAntiAffinity:
        type: soft
    resources:
      cpu:
        cores: 1
      memory:
        container:
          max: 1.5Gi
        redpanda:
          memory: 1Gi
          reserveMemory: 0Mi
    storage:
      persistentVolume:
        enabled: false
      tiered:
        mountType: none
    external:
      enabled: false
    monitoring:
      enabled: true
    tls:
      enabled: false
    auth:
      sasl:
        enabled: false
    listeners:
      admin:
        port: 9644
      kafka:
        port: 9093
      http:
        enabled: true
        port: 8082
      schemaRegistry:
        enabled: true
        port: 8081
    console:
      enabled: true
    tuning:
      tune_aio_events: false
    post_install_job:
      enabled: false
    tests:
      enabled: false
  postRenderers:
  - kustomize:
      patches:
      - target:
          kind: ServiceMonitor
          name: redpanda
        patch: "- op: remove\n  path: /spec/endpoints/0/enableHttp2"
