---
apiVersion: apiextensions.crossplane.io/v2
kind: CompositeResourceDefinition
metadata:
  name: xmodalllms.goyangi.io
spec:
  group: goyangi.io
  names:
    kind: XModalLLM
    plural: xmodalllms
  scope: Cluster
  versions:
    - name: v1alpha1
      served: true
      referenceable: true
      schema:
        openAPIV3Schema:
          type: object
          properties:
            spec:
              type: object
              required:
                - model
              properties:
                model:
                  type: string
                  description: HuggingFace model ID
                revision:
                  type: string
                  description: Model revision/commit hash
                engine:
                  type: string
                  default: vllm
                  enum: [vllm, sglang]
                gpu:
                  type: string
                  default: L4
                  enum: [T4, L4, L40S, A10G, A100, A100-80GB, H100, B200]
                gpuCount:
                  type: integer
                  default: 1
                maxInputs:
                  type: integer
                  default: 32
                scaledownMinutes:
                  type: integer
                  default: 10
                timeoutMinutes:
                  type: integer
                  default: 30
                maxModelLen:
                  type: integer
                  default: 32768
                maxBatchedTokens:
                  type: integer
                  default: 16384
                kvCacheDtype:
                  type: string
                  default: fp8
                  enum: [auto, fp8, fp8_e5m2, fp8_e4m3]
                mistralFormat:
                  type: boolean
                  default: false
                  description: Use Mistral tokenizer/config/load format
                speculative:
                  type: object
                  properties:
                    enabled:
                      type: boolean
                      default: false
                    model:
                      type: string
                    numTokens:
                      type: integer
                      default: 7
                    method:
                      type: string
                      default: eagle3
                    numSteps:
                      type: integer
                      default: 6
                    topk:
                      type: integer
                      default: 10
            status:
              type: object
              properties:
                endpoint:
                  type: string
                ready:
                  type: boolean
