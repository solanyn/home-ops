# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/external-secrets.io/externalsecret_v1.json
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: mlm
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    name: mlm-secret
    creationPolicy: Owner
    template:
      data:
        config.toml: |
          mam_id = "{{ .MAM_ID }}"

          [[qbittorrent]]
          url = "http://qbittorrent.default.svc.cluster.local:80"
          username = "{{ .QBITTORRENT_USERNAME }}"
          password = "{{ .QBITTORRENT_PASSWORD }}"

          [[library]]
          category = "Audiobooks"
          library_dir = "/media/bookdrop/audiobooks"

          [[library]]
          category = "Ebooks"
          library_dir = "/media/bookdrop/ebooks"
  dataFrom:
    - extract:
        key: myanonamouse
    - extract:
        key: qbittorrent
